<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>BloxdTextures</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      background-color: #3D4B79;
      color: white;
      overflow-y: scroll;
      text-align: center;
    }

    #blockContainer {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 20px;
      gap: 20px;
    }

    .BlockItem {
      position: relative;
      width: 64px;
      height: 64px;
      transform: rotateX(60deg) rotateZ(45deg);
      transform-style: preserve-3d;
      border: 1px solid black;
      box-shadow: 0 0 0 1px black;
      background-size: cover;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>üß± BloxdTextures</h1>
  <p>Cliquer sur un bloc pour le t√©l√©charger en rendu 1080x1080.</p>
  <div id="blockContainer"></div>

  <script>
    // Liste de textures fictives, √† remplacer par le vrai contenu du dossier
    const textures = [
      "dirt.png",
      "stone.png",
      "glass_pane.png",
      "lava_still.png",
      "bed_red.png",
      "trapdoor_wood.png",
      "water_flow.png",
      "ice_block.png",
      "oak_door.png"
    ];

    const exceptions = ["bed", "glass", "trapdoor", "door", "lava", "water", "ice"];

    const container = document.getElementById("blockContainer");

    textures.forEach(name => {
      const div = document.createElement("div");
      div.className = "BlockItem";
      div.style.backgroundImage = `url('textures/${name}')`;

      div.addEventListener("click", () => {
        exportBlockImage(`textures/${name}`, name.replace(".png", ""));
      });

      container.appendChild(div);
    });

    function exportBlockImage(url, name) {
      const image = new Image();
      image.crossOrigin = "anonymous";
      image.src = url;

      image.onload = () => {
        const canvas = document.createElement("canvas");
        canvas.width = 1080;
        canvas.height = 1080;
        const ctx = canvas.getContext("2d");

        ctx.clearRect(0, 0, 1080, 1080);

        // Appliquer transformation isom√©trique simplifi√©e
        ctx.save();
        ctx.translate(540, 540);
        ctx.transform(1, -0.5, 1, 0.5, 0, 0);
        ctx.drawImage(image, -256, -256, 512, 512);
        ctx.restore();

        // Contour noir sauf exceptions
        if (!exceptions.some(e => name.includes(e))) {
          ctx.globalCompositeOperation = 'source-over';
          ctx.strokeStyle = 'black';
          ctx.lineWidth = 10;
          ctx.strokeRect(0, 0, 1080, 1080);
        }

        const link = document.createElement('a');
        link.download = name + "_render.png";
        link.href = canvas.toDataURL();
        link.click();
      };
    }
  </script>
</body>
</html>
